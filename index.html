<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>EstateQuoter - Fast, Free Estate Liquidation Quotes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{
  --p:#2153ff;
  --g:#0d9d6a;
  --bg:#f8fafc;
  --t:#0f172a;
  --m:#64748b;
  --r:24px;
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family:system-ui,-apple-system,sans-serif;
  background:var(--bg);
  color:var(--t);
  line-height:1.6;
  min-height:100dvh;
}
.page {
  padding:32px 16px 120px;
  max-width:640px;
  margin:0 auto;
  text-align:center;
}

/* Updated logo */
.logo {
  font-weight:800;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:12px;
  margin-bottom:24px;
}
.logo-mark {
  width:44px;
  height:44px;
  border-radius:999px;
  background:var(--g);
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  box-shadow:0 10px 26px rgba(13,157,106,.35);
}
.logo-mark i {
  font-size:22px;
}
.logo-word {
  font-size:26px;
  letter-spacing:.03em;
}

/* Headline */
h1 { font-size:36px; font-weight:800; margin-bottom:16px; }
h1 span { color:var(--p); }
.sub { font-size:19px; color:#475569; margin-bottom:30px; }
.sub strong { color:var(--g); }

/* Compact header once form is active */
body.form-active .page { padding-top:20px; padding-bottom:60px; }
body.form-active h1 { font-size:28px; margin-bottom:8px; }
body.form-active .sub { font-size:15px; margin-bottom:16px; }

/* Form containers */
.form-container {
  background:#fff;
  border-radius:var(--r);
  box-shadow:0 16px 50px rgba(0,0,0,.1);
  padding:32px 24px;
  text-align:left;
  margin:0 auto;
}

/* Progress / steps */
#main-form { display:none; }
.progress {
  height:10px;
  background:#e2e8f0;
  border-radius:5px;
  overflow:hidden;
  margin-bottom:24px;
}
.bar {
  height:100%;
  background:var(--p);
  width:0;
  transition:width .3s ease;
}
.step-title { font-size:22px; font-weight:700; margin-bottom:4px; }
.encourager { font-size:13px; color:var(--m); margin-bottom:16px; }

.q {
  display:none;
  animation:fade .25s;
}
.q.active { display:block; }
@keyframes fade {
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:none}
}

label {
  display:block;
  font-weight:600;
  margin:20px 0 8px;
  font-size:16px;
}
input[type=text],
input[type=number],
input[type=email],
input[type=tel],
select,
textarea {
  width:100%;
  padding:14px 16px;
  border:1px solid #cbd5e1;
  border-radius:14px;
  font-size:16px;
}

.helper {
  font-size:13px;
  color:var(--m);
  margin-top:4px;
}

/* Range + editable bubble */
.range-wrap {
  position:relative;
  margin:24px 0 48px;
}
input[type=range] {
  width:100%;
  height:8px;
  border-radius:8px;
  background:#e2e8f0;
  outline:none;
  -webkit-appearance:none;
}
input[type=range]::-webkit-slider-thumb {
  -webkit-appearance:none;
  width:28px;
  height:28px;
  border-radius:50%;
  background:var(--p);
  cursor:pointer;
}
.range-value {
  position:absolute;
  top:-60px;
  left:50%;
  transform:translateX(-50%);
  background:var(--p);
  color:#fff;
  padding:8px 16px;
  border-radius:12px;
  font-weight:700;
  font-size:18px;
  white-space:nowrap;
  cursor:text;
  z-index:2;
}
.range-value::after {
  content:"";
  position:absolute;
  bottom:-6px;
  left:50%;
  margin-left:-6px;
  border-width:6px;
  border-style:solid;
  border-color:var(--p) transparent transparent transparent;
}

/* Chips */
.chips {
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin:12px 0;
}
.chip {
  padding:10px 18px;
  border:2px solid #cbd5e1;
  border-radius:999px;
  background:#fff;
  cursor:pointer;
  transition:all .15s;
  font-size:15px;
}
.chip.active {
  border-color:var(--p);
  background:#e0ebff;
  color:var(--p);
}

/* Video box */
.video-box {
  border:3px dashed #94a3b8;
  border-radius:16px;
  padding:32px 20px;
  text-align:center;
  background:#f8fafc;
  cursor:pointer;
}
.video-box.ready {
  border-color:var(--g);
  background:#ecfdf5;
}
#video-preview {
  max-width:100%;
  border-radius:12px;
  margin-top:12px;
  display:none;
}

/* Fixed CTA bar */
.fixed-btn {
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  padding:12px 16px;
  background:#fff;
  box-shadow:0 -8px 40px rgba(0,0,0,.12);
  z-index:100;
}
.btn-row {
  display:flex;
  gap:10px;
  max-width:640px;
  margin:0 auto;
}
.fixed-btn button {
  padding:16px;
  font-size:17px;
  font-weight:700;
  border:none;
  border-radius:999px;
  cursor:pointer;
}
#back-btn {
  flex:1;
  background:#e2e8f0;
  color:#0f172a;
}
#main-btn {
  flex:2;
  background:linear-gradient(135deg,var(--p),#1641cc);
  color:#fff;
  box-shadow:0 10px 30px rgba(33,83,255,.3);
}
#back-btn[disabled] {
  opacity:.4;
  cursor:not-allowed;
}

/* On desktop, CTA bar sits under the card instead of fixed bottom */
@media(min-width:768px) {
  .page { padding-bottom:40px; }
  .fixed-btn {
    position:static;
    box-shadow:none;
    padding:0;
    margin-top:24px;
  }
}

/* Modals */
.modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
  padding:20px;
}
.modal.active { display:flex; }
.modal-content {
  background:#fff;
  border-radius:var(--r);
  padding:32px;
  text-align:center;
  max-width:420px;
}
.modal-content button {
  padding:12px 32px;
  border-radius:999px;
  border:none;
  background:var(--g);
  color:#fff;
  font-weight:700;
  font-size:16px;
  cursor:pointer;
}

/* Review page */
#review {
  display:none;
}
.review-title {
  font-size:24px;
  font-weight:700;
  margin-bottom:8px;
}
.review-sub {
  font-size:14px;
  color:var(--m);
  margin-bottom:20px;
}
.review-grid {
  display:grid;
  grid-template-columns:1fr;
  gap:12px;
}
.review-item {
  padding:10px 12px;
  border-radius:12px;
  background:#f8fafc;
}
.review-item dt {
  font-size:13px;
  font-weight:600;
  color:#64748b;
  margin-bottom:2px;
}
.review-item dd {
  font-size:15px;
  margin:0;
  color:#0f172a;
}
#edit-btn {
  margin-top:20px;
  padding:14px 28px;
  border-radius:999px;
  border:none;
  background:#e2e8f0;
  color:#0f172a;
  font-weight:700;
  cursor:pointer;
}

/* Pointers on primary interactive elements */
button,
.video-box,
.chip,
#zip-submit {
  cursor:pointer;
}

  /* MAKE LOGO CLICKABLE WITHOUT UNDERLINE */
#logo-home {
  text-decoration: none;
  color: inherit;
}
#logo-home:hover {
  text-decoration: none;
}
</style>
</head>
<body>

<div class="page">
  <a href="/" class="logo" id="logo-home">
  <div class="logo-mark">
    <i class="fas fa-house-chimney"></i>
  </div>
  <span class="logo-word">EstateQuoter</span>
</a>


  <h1>Estate liquidation quotes,<br><span>without the hassle.</span></h1>
  <p class="sub">
    Answer a few quick questions and get accurate quotes from trusted local pros - <strong>free and no pressure.</strong>
  </p>

  <!-- ZIP Code First -->
  <div id="zip-section" class="form-container" style="max-width:500px;">
    <label for="zip">Property ZIP code</label>
    <input type="text" id="zip" placeholder="e.g. 23451" maxlength="5" inputmode="numeric" autocomplete="postal-code">
    <p class="helper">We use this to match you with nearby liquidators.</p>
    <div style="margin-top:20px; text-align:right;">
      <button id="zip-submit" style="padding:14px 28px; border:none; border-radius:999px; background:linear-gradient(135deg,var(--p),#1641cc); color:#fff; font-weight:700; font-size:16px;">
        Continue
      </button>
    </div>
  </div>

  <!-- Main Form -->
  <div id="main-form" class="form-container">
    <div class="progress"><div class="bar" id="bar"></div></div>
    <div class="step-title" id="step-title">Property type</div>
    <div class="encourager" id="step-helper">You are on your way. This only takes a minute.</div>

    <!-- 1. Property Type (single) -->
    <div class="q active" data-step="0" data-required="true">
      <label>What type of property is it?</label>
      <div class="chips" data-multi="false">
        <div class="chip active" data-val="House">House</div>
        <div class="chip" data-val="Condo/Townhouse">Condo / Townhouse</div>
        <div class="chip" data-val="Apartment">Apartment</div>
        <div class="chip" data-val="Large estate">Large estate</div>
      </div>
      <p class="helper">Pick the closest option.</p>
    </div>

    <!-- 2. Square Footage -->
    <div class="q" data-step="1" data-required="true">
      <label>Square footage (estimate is fine)</label>
      <div class="range-wrap">
        <input type="range" id="sqft-range" min="400" max="6000" step="100" value="2500">
        <div class="range-value" data-type="sqft" contenteditable="true">2,500 sq ft</div>
      </div>
      <p class="helper">Drag the slider or click the bubble to type a number.</p>
    </div>

    <!-- 3. Beds & Baths -->
    <div class="q" data-step="2" data-required="true">
      <label>Bedrooms</label>
      <select id="beds">
        <option value="">Select</option>
        <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6+</option>
      </select>
      <label style="margin-top:20px">Bathrooms (including half baths)</label>
      <select id="baths">
        <option value="">Select</option>
        <option>1</option><option>1.5</option><option>2</option><option>2.5</option><option>3</option><option>3.5</option><option>4+</option>
      </select>
    </div>

    <!-- 4. Extra Rooms -->
    <div class="q" data-step="3" data-required="true">
      <label>Any of these spaces?</label>
      <div class="chips" data-multi="true">
        <div class="chip" data-val="Attic">Attic</div>
        <div class="chip" data-val="Basement">Basement</div>
        <div class="chip" data-val="Garage">Garage</div>
        <div class="chip" data-val="Shed/Outbuilding">Shed / outbuilding</div>
        <div class="chip" data-val="Pool house">Pool house</div>
        <div class="chip" data-val="None">None of these</div>
      </div>
      <input type="text" id="extra-rooms-other" placeholder="Other (e.g. workshop, mother-in-law suite)" style="margin-top:12px;">
    </div>

    <!-- 5. Fullness Level -->
    <div class="q" data-step="4" data-required="true">
      <label>How full is the property?</label>
      <div class="range-wrap">
        <input type="range" id="fullness-range" min="1" max="4" value="2">
        <div class="range-value" id="fullness-text" data-type="fullness">Medium</div>
      </div>
      <p class="helper">
        1 = Light, 2 = Medium, 3 = Full, 4 = Really full.
      </p>
    </div>

    <!-- 6. High-Value Items -->
    <div class="q" data-step="5" data-required="true">
      <label>Any high value or specialty items?</label>
      <div class="chips" data-multi="true">
        <div class="chip" data-val="Antiques">Antiques</div>
        <div class="chip" data-val="Fine art">Fine art</div>
        <div class="chip" data-val="Jewelry">Jewelry</div>
        <div class="chip" data-val="Collector cars">Collector cars</div>
        <div class="chip" data-val="Firearms">Firearms</div>
        <div class="chip" data-val="Coins or gold">Coins or gold</div>
        <div class="chip" data-val="None or not sure">None or not sure</div>
      </div>
      <input type="text" id="highvalue-other" placeholder="Other high value items" style="margin-top:12px;">
    </div>

    <!-- 7. Clear-out Needs (single) -->
    <div class="q" data-step="6" data-required="true">
      <label>Do you want it cleared & cleaned?</label>
      <div class="chips" data-multi="false">
        <div class="chip active" data-val="no clear-out">No Thanks</div>
        <div class="chip" data-val="Partial clear-out">Partial clear out - some but not all</div>
        <div class="chip" data-val="Full clear-out">Full clear out - everything gone</div>
        <div class="chip" data-val="Not sure yet">Not sure yet</div>
      </div>
      <p class="helper">This helps liquidators understand how much hauling and disposal is needed.</p>
    </div>

    <!-- 8. Timeline (single) -->
    <div class="q" data-step="7" data-required="true">
      <label>How urgent is the timeline?</label>
      <div class="chips" data-multi="false">
        <div class="chip active" data-val="Flexible (30-90 days)">Flexible (about 30-90 days)</div>
        <div class="chip" data-val="2-4 weeks">Somewhat urgent (around 2-4 weeks)</div>
        <div class="chip" data-val="Under 2 weeks">Very urgent (under 2 weeks)</div>
        <div class="chip" data-val="No set deadline">No set deadline</div>
      </div>
    </div>

    <!-- 9. Oversized / Hazardous -->
    <div class="q" data-step="8" data-required="true">
      <label>Oversized or difficult items?</label>
      <div class="chips" data-multi="true">
        <div class="chip" data-val="Grand piano">Grand piano</div>
        <div class="chip" data-val="Gun safe / large safe">Gun safe / large safe</div>
        <div class="chip" data-val="Hot tub">Hot tub</div>
        <div class="chip" data-val="Chemicals / paint / propane">Chemicals / paint / propane</div>
        <div class="chip" data-val="None">None of these</div>
      </div>
      <input type="text" id="oversized-other" placeholder="Other (e.g. very heavy machinery, hoard conditions)" style="margin-top:12px;">
    </div>

    <!-- 10. Access Difficulty (multi + other) -->
    <div class="q" data-step="9" data-required="true">
      <label>How easy is access for trucks and crews?</label>
      <div class="chips" data-multi="true">
        <div class="chip active" data-val="Easy ground-level access">Easy ground level access</div>
        <div class="chip" data-val="Multiple flights of stairs">Multiple flights of stairs</div>
        <div class="chip" data-val="Elevator">Elevator (may be small)</div>
        <div class="chip" data-val="Long carry / narrow driveway">Long carry or narrow/gravel driveway</div>
        <div class="chip" data-val="Gated community">Gated community</div>
        <div class="chip" data-val="Other">Other</div>
      </div>
      <input type="text" id="access-other" placeholder="Describe access challenges" style="margin-top:12px; display:none;">
    </div>

    <!-- 11. Video Walk-through (optional) -->
    <div class="q" data-step="10" data-required="false">
      <label>Optional quick video walk-through</label>
      <p class="helper">This is optional but helps liquidators give the most accurate quote.</p>
      <div class="video-box" id="video-box" onclick="document.getElementById('video-upload').click()">
        <i class="fas fa-video fa-3x" style="color:#94a3b8;margin-bottom:12px;"></i>
        <div style="font-size:18px;font-weight:600;">Tap to record or upload a quick walk-through</div>
        <div style="font-size:14px;color:#64748b;margin-top:8px;">No need to tidy. A simple 30-60 second pass through the rooms is enough.</div>
      </div>
      <video id="video-preview" controls></video>
      <input type="file" id="video-upload" accept="video/*" style="display:none">
      <label style="margin-top:20px;display:none;" id="tc-label">
        <input type="checkbox" id="tc-check">
        I understand this video is private, only used for my quote, and deleted within 30 days.
      </label>
    </div>

    <!-- 12. Estimated Home Value -->
    <div class="q" data-step="11" data-required="true">
      <label>Estimated current home value (as-is, ballpark is fine)</label>
      <div class="range-wrap">
        <input type="range" id="value-range" min="50000" max="1500000" step="25000" value="400000">
        <div class="range-value" id="value-bubble" data-type="value" contenteditable="true">$400,000</div>
      </div>
      <p class="helper">Drag or type the amount in the bubble. This helps set expectations on overall sale potential.</p>
    </div>

    <!-- 13. Contact Info (final step) -->
    <div class="q" data-step="12" data-required="true">
      <label>Your name</label>
      <input type="text" id="name" placeholder="First and last name" required>
      <label style="margin-top:16px">Email</label>
      <input type="email" id="email" placeholder="We will send quotes here" required>
      <label style="margin-top:16px">Phone</label>
      <input type="tel" id="phone" placeholder="Mobile number" required>
      <label style="margin-top:20px">Anything else we should know?</label>
      <textarea id="notes" rows="3" placeholder="Timeline, attorney involvement, locked areas, special requests, etc."></textarea>
    </div>
  </div>

  <!-- Review Page -->
  <div id="review" class="form-container">
    <div class="review-title">Review your request</div>
    <div class="review-sub">
      Here is a simple summary of what you shared. If something looks off, scroll down and click "edit answers" at the bottom and we'll update that info for your local pros.
    </div>
    <div class="review-grid" id="review-grid"></div>
    <button id="edit-btn">Edit answers</button>
  </div>
</div>

<!-- Single Fixed Button Bar -->
<div class="fixed-btn" id="cta-bar" style="display:none;">
  <div class="btn-row">
    <button id="back-btn">Back</button>
    <button id="main-btn">Next</button>
  </div>
</div>

<!-- Hampton Roads Modal -->
<div class="modal" id="hr-modal">
  <div class="modal-content">
    <i class="fas fa-check-circle fa-4x" style="color:var(--g);margin-bottom:16px;"></i>
    <h2 style="color:var(--g); margin-bottom:8px;">Great news</h2>
    <p style="font-size:16px; margin:8px 0 0;">
      You are in the Hampton Roads area. We have in-network partners and can usually get you a detailed quote within 24 hours.
    </p>
    <button style="margin-top:24px;" onclick="closeHRModal()">Continue</button>
  </div>
</div>

<!-- Completion Modal -->
<div class="modal" id="complete-modal">
  <div class="modal-content">
    <i class="fas fa-thumbs-up fa-4x" style="color:var(--g);margin-bottom:16px;"></i>
    <h2 style="color:var(--g); margin-bottom:8px;">You are all set</h2>
    <p style="font-size:16px; margin:8px 0 0;">
      That's it! Check your email for confirmation, and expect quotes within 24 to 48 hours. Feel free to review and update your answers if needed!
    </p>
    <button style="margin-top:24px;" onclick="closeCompleteModal()">Review my answers</button>
  </div>
</div>

<!-- Capture visitor metadata (IP, geo, device, referrer, etc.) -->
<script>
window._eqMeta = {};

(async function () {
  try {
    const res = await fetch("https://ipapi.co/json/");
    if (!res.ok) return;
    const geo = await res.json();

    window._eqMeta = {
      ip: geo.ip || "",
      city: geo.city || "",
      region: geo.region || "",
      country: geo.country_name || "",
      postal: geo.postal || "",
      latitude: geo.latitude || "",
      longitude: geo.longitude || "",
      isp: geo.org || "",
      userAgent: navigator.userAgent || "",
      referrer: document.referrer || "",
      pageUrl: window.location.href || "",
      device: /Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)
        ? "Mobile"
        : "Desktop"
    };
  } catch (e) {
    console.error("Meta capture failed", e);
  }
})();
</script>

<script>
const hamptonRoadsZips = new Set([
  "23451","23452","23453","23454","23455","23456","23457","23458","23459","23460","23461","23462","23463","23464","23465","23466","23467","23471","23479",
  "23320","23321","23322","23323","23324","23325","23326","23327","23328",
  "23502","23503","23504","23505","23507","23508","23509","23510","23511","23513","23517","23518","23523",
  "23701","23702","23703","23704","23707","23708","23709",
  "23661","23662","23663","23664","23665","23666","23667","23668","23669","23670","23681",
  "23601","23602","23603","23604","23605","23606","23607","23608","23609","23612","23628","23630"
]);

let currentStep = 0;
const qs = document.querySelectorAll('#main-form .q');
const totalSteps = qs.length;
const bar = document.getElementById('bar');
const stepTitle = document.getElementById('step-title');
const stepHelper = document.getElementById('step-helper');
const ctaBar = document.getElementById('cta-bar');
const backBtn = document.getElementById('back-btn');
const mainBtn = document.getElementById('main-btn');

const titles = [
  "Property type",
  "Square footage",
  "Bedrooms and baths",
  "Extra rooms or spaces",
  "How full is it",
  "High value items",
  "Clear out needs",
  "Timeline",
  "Oversized items",
  "Access difficulty",
  "Optional video",
  "Estimated home value",
  "Final details"
];

const encouragements = [
  "You are off to a great start.",
  "Nice. This helps get realistic quotes.",
  "Bedrooms and baths tell pros how many rooms to staff.",
  "Extra spaces often add value. You are doing fine.",
  "Almost there. A sense of fullness goes a long way.",
  "This helps match you with the right kind of liquidator.",
  "Clear out needs help avoid surprise costs later.",
  "Timeline helps everyone plan and stay calm.",
  "This keeps crews safe and prepared.",
  "Access is a big factor. You are almost done.",
  "Optional, but it really helps. No need to tidy.",
  "This just sets expectations. Ballpark is enough.",
  "Last step. Then you can review everything."
];

function updateProgress() {
  const percent = ((currentStep + 1) / totalSteps) * 100;
  bar.style.width = percent + '%';
  stepTitle.textContent = titles[currentStep] || '';
  stepHelper.textContent = encouragements[currentStep] || "You are doing great. A few more details and you will be done.";
  backBtn.disabled = currentStep === 0;
  mainBtn.textContent = currentStep === totalSteps - 1 ? "Submit request" : "Next";
  window.scrollTo(0,0);
}

function showStep(step) {
  qs[currentStep].classList.remove('active');
  currentStep = step;
  qs[currentStep].classList.add('active');
  updateProgress();
}

function validateStep(stepIndex) {
  const step = qs[stepIndex];
  const required = step.getAttribute('data-required') === 'true';
  if (!required) return true;

  switch(stepIndex) {
    case 0: {
      const activeChip = step.querySelector('.chip.active');
      if (!activeChip) {
        alert('Please select the property type.');
        return false;
      }
      return true;
    }
    case 1: {
      const val = parseInt(document.getElementById('sqft-range').value, 10);
      if (!val || isNaN(val)) {
        alert('Please set an approximate square footage.');
        return false;
      }
      return true;
    }
    case 2: {
      const beds = document.getElementById('beds').value;
      const baths = document.getElementById('baths').value;
      if (!beds || !baths) {
        alert('Please select both bedrooms and bathrooms.');
        return false;
      }
      return true;
    }
    case 3: {
      const chips = step.querySelectorAll('.chip.active');
      if (chips.length === 0) {
        alert('Please select if there are extra spaces, or choose \"None of these\".");
        return false;
      }
      return true;
    }
    case 4: {
      const val = parseInt(document.getElementById('fullness-range').value, 10);
      if (!val || isNaN(val)) {
        alert('Please tell us roughly how full the property is.');
        return false;
      }
      return true;
    }
    case 5: {
      const chips = step.querySelectorAll('.chip.active');
      if (chips.length === 0) {
        alert('Please select any high value items, or choose \"None or not sure\".");
        return false;
      }
      return true;
    }
    case 6: {
      const chip = step.querySelector('.chip.active');
      if (!chip) {
        alert('Please tell us what kind of clear out you need.');
        return false;
      }
      return true;
    }
    case 7: {
      const chip = step.querySelector('.chip.active');
      if (!chip) {
        alert('Please select a timeline.');
        return false;
      }
      return true;
    }
    case 8: {
      const chips = step.querySelectorAll('.chip.active');
      if (chips.length === 0) {
        alert('Please tell us if there are any oversized items, or choose \"None of these\".");
        return false;
      }
      return true;
    }
    case 9: {
      const chips = step.querySelectorAll('.chip.active');
      if (chips.length === 0) {
        alert('Please tell us about access difficulty.');
        return false;
      }
      const otherChip = step.querySelector('.chip.active[data-val=\"Other\"]');
      if (otherChip) {
        const txt = document.getElementById('access-other').value.trim();
        if (!txt) {
          alert('Please describe the access challenges.');
          return false;
        }
      }
      return true;
    }
    case 11: {
      const val = parseInt(document.getElementById('value-range').value, 10);
      if (!val || isNaN(val)) {
        alert('Please set an estimated home value.');
        return false;
      }
      return true;
    }
    case 12: {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      if (!name) {
        alert('Please enter your name.');
        return false;
      }
      if (!email) {
        alert('Please enter your email so we can send quotes.');
        return false;
      }
      if (!/^\S+@\S+\.\S+$/.test(email)) {
        alert('Please enter a valid email address.');
        return false;
      }
      if (!phone) {
        alert('Please enter a phone number.');
        return false;
      }
      return true;
    }
    default:
      return true;
  }
}

/* Collect data for review */
function collectData() {
  const data = {};
  data.zip = document.getElementById('zip').value.trim();

  const step0Chip = qs[0].querySelector('.chip.active');
  data.propertyType = step0Chip ? (step0Chip.dataset.val || step0Chip.textContent.trim()) : '';

  data.squareFootage = parseInt(document.getElementById('sqft-range').value, 10);

  data.bedrooms = document.getElementById('beds').value;
  data.bathrooms = document.getElementById('baths').value;

  const step3 = qs[3];
  const extraChips = step3.querySelectorAll('.chip.active');
  data.extraRooms = extraChips.length
    ? Array.from(extraChips).map(c => c.dataset.val || c.textContent.trim()).join(', ')
    : 'None';
  data.extraRoomsOther = document.getElementById('extra-rooms-other').value.trim();

  const fullnessVal = parseInt(document.getElementById('fullness-range').value, 10);
  let fullnessLabel = 'Medium';
  if (fullnessVal === 1) fullnessLabel = 'Light';
  if (fullnessVal === 2) fullnessLabel = 'Medium';
  if (fullnessVal === 3) fullnessLabel = 'Full';
  if (fullnessVal === 4) fullnessLabel = 'Really full';
  data.fullness = fullnessLabel;

  const step5 = qs[5];
  const hvChips = step5.querySelectorAll('.chip.active');
  data.highValue = hvChips.length
    ? Array.from(hvChips).map(c => c.dataset.val || c.textContent.trim()).join(', ')
    : 'None or not sure';
  data.highValueOther = document.getElementById('highvalue-other').value.trim();

  const step6Chip = qs[6].querySelector('.chip.active');
  data.clearOut = step6Chip ? (step6Chip.dataset.val || step6Chip.textContent.trim()) : '';

  const step7Chip = qs[7].querySelector('.chip.active');
  data.timeline = step7Chip ? (step7Chip.dataset.val || step7Chip.textContent.trim()) : '';

  const step8 = qs[8];
  const osChips = step8.querySelectorAll('.chip.active');
  data.oversized = osChips.length
    ? Array.from(osChips).map(c => c.dataset.val || c.textContent.trim()).join(', ')
    : 'None';
  data.oversizedOther = document.getElementById('oversized-other').value.trim();

  const step9 = qs[9];
  const accChips = step9.querySelectorAll('.chip.active');
  data.access = accChips.length
    ? Array.from(accChips).map(c => c.dataset.val || c.textContent.trim()).join(', ')
    : '';
  data.accessOther = document.getElementById('access-other').value.trim();

  const videoPreview = document.getElementById('video-preview');
  data.hasVideo = !!videoPreview.src;
  data.videoConsentChecked = document.getElementById('tc-check').checked;

  data.homeValue = parseInt(document.getElementById('value-range').value, 10);

  data.name = document.getElementById('name').value.trim();
  data.email = document.getElementById('email').value.trim();
  data.phone = document.getElementById('phone').value.trim();
  data.notes = document.getElementById('notes').value.trim();

  // Visitor metadata (from window._eqMeta)
  const meta = window._eqMeta || {};

  data.ip = meta.ip || "";
  data.city = meta.city || "";
  data.region = meta.region || "";
  data.country = meta.country || meta.country_name || "";
  data.postal = meta.postal || "";
  data.latitude = meta.latitude || "";
  data.longitude = meta.longitude || "";
  data.isp = meta.isp || "";
  data.device = meta.device || "";
  data.userAgent = meta.userAgent || "";
  data.referrer = meta.referrer || "";
  data.pageUrl = meta.pageUrl || "";

  const ispLower = (meta.isp || "").toLowerCase();
  const vpnHints = [
    "vpn",
    "hosting",
    "digitalocean",
    "ovh",
    "aws",
    "amazon",
    "microsoft",
    "azure",
    "google",
    "cloud",
    "hetzner"
  ];
  data.likelyVPN = vpnHints.some(k => ispLower.includes(k)) ? "Yes" : "No";

  return data;
}

/* Render review page */
function renderReview(data) {
  const grid = document.getElementById('review-grid');
  const fmtMoney = n => n ? '$' + n.toLocaleString() : '';
  const fmtSqft = n => n ? n.toLocaleString() + ' sq ft' : '';

  const items = [
    { label: "ZIP code", value: data.zip || '-' },
    { label: "Property type", value: data.propertyType || '-' },
    { label: "Square footage", value: fmtSqft(data.squareFootage) || '-' },
    { label: "Bedrooms", value: data.bedrooms || '-' },
    { label: "Bathrooms", value: data.bathrooms || '-' },
    { label: "Extra rooms or spaces", value: [data.extraRooms, data.extraRoomsOther].filter(Boolean).join(' | ') || '-' },
    { label: "How full it is", value: data.fullness || '-' },
    { label: "High value items", value: [data.highValue, data.highValueOther].filter(Boolean).join(' | ') || '-' },
    { label: "Clear out needs", value: data.clearOut || '-' },
    { label: "Timeline", value: data.timeline || '-' },
    { label: "Oversized / difficult items", value: [data.oversized, data.oversizedOther].filter(Boolean).join(' | ') || '-' },
    { label: "Access", value: [data.access, data.accessOther].filter(Boolean).join(' | ') || '-' },
    { label: "Home value estimate", value: fmtMoney(data.homeValue) || '-' },
    { label: "Name", value: data.name || '-' },
    { label: "Email", value: data.email || '-' },
    { label: "Phone", value: data.phone || '-' },
    { label: "Notes", value: data.notes || 'None' },
    { label: "Video provided", value: data.hasVideo ? "Yes" : "No" }
  ];

  grid.innerHTML = items.map(item => `
    <div class="review-item">
      <dl>
        <dt>${item.label}</dt>
        <dd>${item.value}</dd>
      </dl>
    </div>
  `).join('');
}

/* ZIP submit */
document.getElementById('zip-submit').onclick = () => {
  const zip = document.getElementById('zip').value.trim();
  if (!/^\d{5}$/.test(zip)) {
    alert('Please enter a valid 5 digit ZIP code.');
    return;
  }
  if (hamptonRoadsZips.has(zip)) {
    document.getElementById('hr-modal').classList.add('active');
  }
  document.getElementById('zip-section').style.display = 'none';
  document.getElementById('main-form').style.display = 'block';
  document.body.classList.add('form-active');
  ctaBar.style.display = 'block';
  qs[0].classList.add('active');
  updateProgress();
};

function closeHRModal() {
  document.getElementById('hr-modal').classList.remove('active');
}
function closeCompleteModal() {
  document.getElementById('complete-modal').classList.remove('active');
  document.getElementById('review').style.display = 'block';
}
window.closeHRModal = closeHRModal;
window.closeCompleteModal = closeCompleteModal;

/* Chips behavior */
document.querySelectorAll('.chips').forEach(group => {
  const multi = group.getAttribute('data-multi') === 'true';
  group.addEventListener('click', e => {
    const chip = e.target.closest('.chip');
    if (!chip) return;

    if (multi) {
      chip.classList.toggle('active');

      const noneValues = ["None", "None of these", "None or not sure"];
      if (noneValues.includes(chip.dataset.val)) {
        if (chip.classList.contains('active')) {
          group.querySelectorAll('.chip').forEach(c => {
            if (c !== chip) c.classList.remove('active');
          });
        }
      } else {
        group.querySelectorAll('.chip').forEach(c => {
          if (noneValues.includes(c.dataset.val)) c.classList.remove('active');
        });
      }
    } else {
      group.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
      chip.classList.add('active');
    }

    const parentStep = group.parentElement.getAttribute('data-step');
    if (parentStep === '9') {
      const otherInput = document.getElementById('access-other');
      const anyOtherActive = group.querySelector('.chip.active[data-val=\"Other\"]');
      if (anyOtherActive) {
        otherInput.style.display = 'block';
      } else {
        otherInput.style.display = 'none';
        otherInput.value = '';
      }
    }
  });
});

/* Range sliders + editable bubbles */
function formatRange(slider, bubble) {
  const val = parseInt(slider.value, 10);
  const type = bubble.getAttribute('data-type');

  if (type === 'sqft') {
    bubble.textContent = val.toLocaleString() + ' sq ft';
  } else if (type === 'value') {
    bubble.textContent = '$' + val.toLocaleString();
  } else if (type === 'fullness') {
    let label = 'Medium';
    if (val === 1) label = 'Light';
    if (val === 2) label = 'Medium';
    if (val === 3) label = 'Full';
    if (val === 4) label = 'Really full';
    bubble.textContent = label;
  }

  const min = parseInt(slider.min, 10);
  const max = parseInt(slider.max, 10);
  const percent = (val - min) / (max - min) * 100;
  bubble.style.left = percent + '%';
}

document.querySelectorAll('.range-wrap').forEach(wrap => {
  const slider = wrap.querySelector('input[type=range]');
  const bubble = wrap.querySelector('.range-value');
  if (!slider || !bubble) return;

  formatRange(slider, bubble);
  slider.addEventListener('input', () => formatRange(slider, bubble));

  bubble.addEventListener('blur', () => {
    const raw = bubble.textContent;
    const digits = raw.replace(/[^\d]/g, '');
    if (!digits) {
      formatRange(slider, bubble);
      return;
    }
    let val = parseInt(digits, 10);
    const min = parseInt(slider.min, 10);
    const max = parseInt(slider.max, 10);
    if (val < min) val = min;
    if (val > max) val = max;
    slider.value = val;
    formatRange(slider, bubble);
  });

  bubble.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      bubble.blur();
    }
  });
});

/* Video upload preview (optional) */
document.getElementById('video-upload').onchange = e => {
  const file = e.target.files[0];
  if (file && file.type.startsWith('video/')) {
    const url = URL.createObjectURL(file);
    const prev = document.getElementById('video-preview');
    prev.src = url;
    prev.style.display = 'block';
    document.getElementById('video-box').classList.add('ready');
    document.getElementById('tc-label').style.display = 'block';
  } else {
    alert('Please upload a video file.');
    e.target.value = '';
  }
};

/* Navigation buttons */
mainBtn.onclick = () => {
  if (!validateStep(currentStep)) return;

  if (currentStep === totalSteps - 1) {
    const data = collectData();
    sendLeadToMake(data);
    renderReview(data);
    document.getElementById('main-form').style.display = 'none';
    ctaBar.style.display = 'none';
    document.getElementById('complete-modal').classList.add('active');
    return;
  }
  showStep(currentStep + 1);
};

backBtn.onclick = () => {
  if (currentStep === 0) return;
  showStep(currentStep - 1);
};

document.getElementById('edit-btn').onclick = () => {
  document.getElementById('review').style.display = 'none';
  document.getElementById('main-form').style.display = 'block';
  ctaBar.style.display = 'block';
  showStep(0);
};
</script>

<script>
async function sendLeadToMake(leadData) {
  const webhookURL = "https://hook.us2.make.com/yp7lklk38381i0lubdj2v02v1v4es9s3";

  try {
    await fetch(webhookURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(leadData)
    });
  } catch (err) {
    console.error("Make.com send failed:", err);
  }
}
</script>

</body>
</html>
